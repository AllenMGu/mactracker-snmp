<!doctype html>
<html>
<head>
  <title>按日期查看采集结果</title>
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css">
</head>
<body class="p-4">
  <h1>按日期查看采集结果</h1>
  <a href="/" class="btn btn-secondary mb-3">返回首页</a>
  
  {% if error_message %}
    <div class="alert alert-danger">
      <p>{{ error_message }}</p>
    </div>
  {% endif %}
  
  <form method="get" action="/by_date" class="mb-4">
    <div class="row">
      <div class="col-md-6">
        <label for="dateSelect" class="form-label">选择日期</label>
        <select class="form-select" id="dateSelect" name="date" onchange="this.form.submit()">
          <option value="">-- 请选择日期 --</option>
          {% for date in dates %}
          <option value="{{ date }}" {% if date == selected_date %}selected{% endif %}>
            {{ date }}
          </option>
          {% endfor %}
        </select>
      </div>
    </div>
  </form>
  
  {% if selected_date %}
    <h2>{{ selected_date }} 的采集结果</h2>
    {% if results %}
    <table class="table table-striped">
      <tr><th>设备</th><th>VLAN</th><th>MAC</th><th>端口</th><th>时间</th></tr>
      {% for r in results %}
      <tr>
        <td>{{ r.device }}</td>
        <td>{{ r.vlan }}</td>
        <td>{{ r.mac }}</td>
        <td>{{ r.port }}</td>
        <td>{{ r.timestamp.strftime('%Y-%m-%d %H:%M:%S') }}</td>
      </tr>
      {% endfor %}
    </table>
    {% else %}
    <div class="alert alert-info">该日期没有采集到数据</div>
    {% endif %}
  {% endif %}
</body>
</html>